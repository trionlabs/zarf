<!doctype html>
<html lang="en" data-theme="glass-porcelain">

<head>
	<!-- Buffer polyfill - MUST load synchronously before any modules (MetaMask SES timing) -->
	<script src="https://unpkg.com/buffer@6.0.3/index.js"></script>
	<script>
		if (typeof globalThis !== 'undefined' && typeof buffer !== 'undefined') {
			globalThis.Buffer = buffer.Buffer;
			window.Buffer = buffer.Buffer;
		}
	</script>

	<meta charset="utf-8" />
	<link rel="icon" href="%sveltekit.assets%/favicon.svg" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="theme-color" content="#000000" />
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link
		href="https://fonts.googleapis.com/css2?family=Saira:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
		rel="stylesheet">

	<!-- SES/Svelte 5 Compatibility Patch: runtime defensive shim against MetaMask lockdown -->
	<script>
		(function () {
			if (typeof window === 'undefined') return;
			// Patch Object.getOwnPropertyDescriptor to fool Svelte 5 when SES locks down intrinsics
			var originalGOPD = Object.getOwnPropertyDescriptor;
			var domProps = ['nextSibling', 'previousSibling', 'firstChild', 'lastChild', 'childNodes'];

			Object.getOwnPropertyDescriptor = function (obj, prop) {
				var desc = originalGOPD(obj, prop);
				if ((obj === Node.prototype || obj === Element.prototype) && domProps.indexOf(prop) !== -1) {
					// If descriptor is missing or SES removed the getter
					if (!desc || !desc.get) {
						return {
							configurable: true, enumerable: true,
							get: function () { return this[prop]; }
						};
					}
				}
				return desc;
			};
		})();
	</script>

	<!-- Theme script to prevent flash during hydration -->
	<script>
		(function () {
			try {
				var stored = localStorage.getItem('zarf_theme');
				var theme = 'dark'; // default

				if (stored === 'light' || stored === 'dark') {
					theme = stored;
				} else {
					localStorage.setItem('zarf_theme', 'dark');
				}

				// Map to specific DaisyUI themes
				var daisyTheme = theme === 'light' ? 'paper-porcelain' : 'glass-porcelain';
				document.documentElement.setAttribute('data-theme', daisyTheme);
			} catch (e) { }
		})();
	</script>

	%sveltekit.head%
</head>

<body data-sveltekit-preload-data="hover">
	<div style="display: contents">%sveltekit.body%</div>
</body>

</html>